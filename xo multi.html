<!DOCTYPE html>
<html>
<head>
<style>
table, th, td {
  border: 4px solid black;
  border-collapse: collapse;
}

th, tr {
  font-size: 50px;
  height: 80px;
  width: 80px;
}
</style>
</head>
<body>
<table id="field">
  <tr>
    <th id="t00"> </th> 
    <th id="t01"> </th>
    <th id="t02"> </th>
  </tr>
  <tr>
    <th id="t10"> </th> 
    <th id="t11"> </th>
    <th id="t12"> </th>
  <tr>
    <th id="t20"> </th> 
    <th id="t21"> </th>
    <th id="t22"> </th>
  </tr>
 </table>

 <h2 id="step">Ход X </h2>
 <h1><pre id="winner"> </pre> </h1>
<h2> <pre>  X = <b id="cntX"> 0 </b> </pre></h2>
<h2> <pre>  O = <b id="cntO"> 0 </b></pre></h2>

<script type="text/javascript">
  var symbolX = "✕";
  var symbolO = "○";

  let game = {
    gameId: "t",
    field: [
        [, ,],
        [, ,],
        [, ,]
    ],
    countX: 0,
    countO: 0,
    nextSymbolIsX: true,
    endGame: false
  };
  
	function CheckGame(field) {	//проверка
		//проверка победителя по горизонтали	
		this.field = field;
		for (let i = 0; i < 3; i++) {
			if (((this.field[i][0]===symbolX)&&
				(this.field[i][1]===symbolX)&&
				(this.field[i][2]===symbolX))) {
					this.endGame = true;
					return 1;
			}
			
			if (((this.field[i][0]===symbolO)&&
				(this.field[i][1]===symbolO)&&
				(this.field[i][2]===symbolO))) {
					this.endGame = true;
					return 2;
			}
		}
		//проверка победителя по вертикали		
		for (let j = 0; j < 3; j++) {
			if (((this.field[0][j]===symbolX)&&
				 (this.field[1][j]===symbolX)&&
				 (this.field[2][j]===symbolX))) {
					this.endGame = true;
				return 1;
			}
		 
			if (((this.field[0][j]===symbolO)&&
				 (this.field[1][j]===symbolO)&&
				 (this.field[2][j]===symbolO))) {
					this.endGame = true;
				return 2;
			}
		}
		//проверка победителя по диагоналям	
		if (((this.field[0][0]===symbolX)&&
		 	 (this.field[1][1]===symbolX)&&
			 (this.field[2][2]===symbolX))||
			((this.field[0][2]===symbolX)&&
		 	 (this.field[1][1]===symbolX)&&
		 	 (this.field[2][0]===symbolX))) {
				this.endGame = true;
					return 1;
		}
		
		if (((this.field[0][0]===symbolO)&&
		 	(this.field[1][1]===symbolO)&&
		 	(this.field[2][2]===symbolO))||
			((this.field[0][2]===symbolO)&&
		 	(this.field[1][1]===symbolO)&&
		 	(this.field[2][0]===symbolO))) {
				this.endGame = true;
					return 2;
		}
	
		//Проверка ничьи
		for (let i = 0; i < 3; i++) {
			for (let j = 0; j < 3; j++) {
				if (this.field[i][j] == undefined) return 0;
			}
		}
		this.endGame = true;
		return 3;
 	}

  	function ClearField(field) {
		this.field = field;
		for (let i = 0; i < 3; i++) {
			for (let j = 0; j < 3; j++) {
				this.field[i][j]=undefined;
				var id = "t" + i + j;
				var cell = document.getElementById(id);
				cell.firstChild.nodeValue = "";
				console.log(cell);
			}	
		}
		this.endGame = false;
		winner.firstChild.nodeValue = " ";
 	}

 	function ShowSymbol(field,nextSymbolIsX) {
		 this.field = field;
		 this.nextSymbolIsX = nextSymbolIsX;

		// получает элемент на который кликнули
    	var clickedElement = event.target;
		
    	// получает id элемента на который кликнули
    	// затем берет второй символ от id, "t2" => "2"
  	  	// затем parseInt чтобы получить из сроки "2" интеджер 2
  	 	var indexOfElementHor = parseInt(clickedElement.id.substring(1,2), 10);
		var indexOfElementVer = parseInt(clickedElement.id.substring(2,3), 10);
		//проверка ячейки, свободна ли она	
		if (this.field[indexOfElementHor][indexOfElementVer]===undefined) {
			if (this.nextSymbolIsX) {
				this.field[indexOfElementHor][indexOfElementVer] = symbolX;
				clickedElement.firstChild.nodeValue = symbolX;
				this.nextSymbolIsX = !this.nextSymbolIsX;
			}	else {
				this.field[indexOfElementHor][indexOfElementVer] = symbolO;
				clickedElement.firstChild.nodeValue = symbolO;
				this.nextSymbolIsX = !this.nextSymbolIsX;
			}
		}
		// выводит в консоль элемент и индекс
		console.log(clickedElement, indexOfElementHor,indexOfElementVer);
		// вывести в консоль состояние поля
  	  	console.log(field);	
	}

  	function StepText(nextSymbolIsX) { // чей ход?
	    this.nextSymbolIsX = nextSymbolIsX;
		if (this.nextSymbolIsX) {
			step.firstChild.nodeValue = "Ход X";
		} else {
			step.firstChild.nodeValue = "Ход O";
		}	
  	}

	function WinnerText(countX,countO) {
		this.countX = countX;
		this.countO = countO;
		switch(CheckGame()) {
			case 1: 
				winner.firstChild.nodeValue = "Победа за Х";
				step.firstChild.nodeValue = "Клик для новой игры";
				this.countX++;
				break;
			case 2: 
				winner.firstChild.nodeValue = "Победа за O";
				step.firstChild.nodeValue = "Клик для новой игры";
				this.countO++;
				break;
			case 3: 
				winner.firstChild.nodeValue = "Ничья";
				step.firstChild.nodeValue = "Клик для новой игры";
				break;
		}
	}  
  	
	function countText() {
		cntX.firstChild.nodeValue = this.countX;
		cntO.firstChild.nodeValue = this.countO;
	}  

	function proccesClick() { 
		if (!game.endGame) {
			ShowSymbol(game.field, game.nextSymbolIsX);
			StepText(game.nextSymbolIsX);
			CheckGame(game.field);
			WinnerText(game.countX, game.countO);
			countText();
		} else {
			countText();
			StepText(game.nextSymbolIsX);
			ClearField(game.field);

		}
	
		
	}
	    	


  

	var el = document.getElementById("field");
	el.addEventListener("click", proccesClick, false);  
  
 
  
  
</script>
</body>
</html>